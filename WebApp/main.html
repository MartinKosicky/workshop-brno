<html>

<head>
    <link rel="stylesheet" type="text/css" href="./node_modules/bootstrap/dist/css/bootstrap.css" />
    <script type="text/javascript" src="./node_modules/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="./node_modules/bootstrap/dist/js/bootstrap.bundle.js"></script>
    <script type="text/javascript" src="./node_modules/chart.js/dist/Chart.bundle.js"></script>
    <script type="text/javascript">


        function ScheduleBarUpdate(dataSource, chart) {
            $.ajax({
                url: dataSource
            }).done( function(data) {
                var values = [];
                var labels = []
                for(var i=0;i<data.length;i++) {
                    values.push(data[i].count);
                    labels.push(data[i].name);
                }

                chart.data.labels = labels;
                chart.data.datasets[0].data = values
                chart.update();
            });

            setTimeout(function() {
                ScheduleBarUpdate(dataSource, chart);
            }, 2000);
        }

        function SetBarGraph(id, dataSource, label) {
            var ctx = document.getElementById(id).getContext('2d');
            var myData = []
            var chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets:[{
                        label:label,
                        backgroundColor: 'rgb(255, 99, 132)',
                        data:[]
                    }]
                },
            });

            ScheduleBarUpdate(dataSource,chart, label)
        }

        $(document).ready(function(){
            SetBarGraph("top-apps", "http://localhost:9999/top_applications/0", "Applicaion");
            SetBarGraph("least-apps", "http://localhost:9999/least_applications/0", "Applicaion");
        })

        


    </script>

</head>

<body>

    <div class="container">

        
            <div class="d-flex">
                <div class="card m-4" style="width:500px">
                    <canvas id="top-apps"></canvas>
                    <div class="card-body">
                        <h5 class="card-title">Top installed applications</h5>
                        <p class="card-text">Applications that are installed the most and not whitelisted</p>
                    </div>
                </div>
                <div class="card m-4" style="width:500px">
                        <canvas id="least-apps"></canvas>
                        <div class="card-body">
                            <h5 class="card-title">Least installed applications</h5>
                            <p class="card-text">Applications that are installed the least and not whitelisted</p>
                        </div>
                </div>
            </div>             
        </div>

    </div>



</body>



</html>